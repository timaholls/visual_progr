# Лабораторная работа 4.1 и 4.2 - WPF-приложение с использованием MVVM и паттерна Command

## Описание задания

Данная лабораторная работа направлена на создание WPF-приложения для обработки данных по сотрудникам компании с использованием паттерна MVVM (Model-View-ViewModel) и паттерна Command. Приложение позволяет просматривать, добавлять, редактировать и удалять данные о сотрудниках и их должностях.

## Структура проекта

Проект реализован с использованием архитектуры MVVM, что обеспечивает четкое разделение бизнес-логики и пользовательского интерфейса. Структура проекта выглядит следующим образом:

```
4_1/
├── 4_1/
│   ├── Model/                # Модели данных
│   │   ├── Person.cs         # Класс сотрудника
│   │   ├── Role.cs           # Класс должности
│   │   ├── PersonDPO.cs      # Класс отображения данных о сотруднике
│   │   └── FindRole.cs       # Класс для поиска должности
│   ├── Helper/               # Вспомогательные классы
│   │   └── RelayCommand.cs   # Реализация интерфейса ICommand
│   ├── ViewModel/            # Модели представления
│   │   ├── ViewModelBase.cs  # Базовый класс для всех ViewModel
│   │   ├── PersonViewModel.cs # ViewModel для работы с сотрудниками
│   │   └── RoleViewModel.cs  # ViewModel для работы с должностями
│   └── View/                 # Представления (окна)
│       ├── MainWindow.xaml   # Главное окно
│       ├── WindowEmployee.xaml # Окно со списком сотрудников
│       ├── WindowRole.xaml   # Окно со списком должностей
│       ├── EditEmployeeWindow.xaml # Окно редактирования сотрудника
│       └── EditRoleWindow.xaml # Окно редактирования должности
├── 4_1.sln                   # Файл решения Visual Studio
└── README.md                 # Документация проекта
```

## Компоненты приложения

### Модели (Model)

#### Person.cs
Класс `Person` представляет сотрудника компании и содержит следующие свойства:
- `Id` - уникальный идентификатор
- `RoleId` - идентификатор должности
- `FirstName` - имя сотрудника
- `LastName` - фамилия сотрудника
- `Birthday` - дата рождения

Класс является обычной моделью данных без реализации интерфейса `INotifyPropertyChanged`.

#### Role.cs
Класс `Role` представляет должность и содержит следующие свойства:
- `Id` - уникальный идентификатор
- `NameRole` - наименование должности
- `RolePredicate` - метод для проверки соответствия должности по ID

Класс реализует интерфейс `INotifyPropertyChanged` для уведомления об изменениях свойств.

#### PersonDPO.cs
Класс `PersonDPO` (Data Presentation Object) используется для отображения данных о сотруднике с указанием должности в виде строки (не ID):
- `Id` - уникальный идентификатор
- `Role` - название должности (строка)
- `FirstName` - имя сотрудника
- `LastName` - фамилия сотрудника
- `Birthday` - дата рождения

Класс реализует интерфейс `INotifyPropertyChanged` для уведомления об изменениях свойств.

#### FindRole.cs
Класс `FindRole` предназначен для поиска должности по ID и содержит метод:
- `RolePredicate` - предикат для поиска должности по ID, хранящемуся в экземпляре класса

### Вспомогательные классы (Helper)

#### RelayCommand.cs
Класс `RelayCommand` реализует интерфейс `ICommand` и используется для связывания команд в ViewModel с действиями в View через привязку данных:
- `Execute` - выполнение команды
- `CanExecute` - определение возможности выполнения команды
- `CanExecuteChanged` - событие изменения состояния команды, связанное с CommandManager.RequerySuggested

### Модели представления (ViewModel)

#### ViewModelBase.cs
Базовый класс для всех ViewModel, реализующий интерфейс `INotifyPropertyChanged` для уведомления UI об изменениях в свойствах:
- `PropertyChanged` - событие изменения свойства
- `OnPropertyChanged` - метод вызова события
- `SetProperty` - метод для установки значения свойства с вызовом события

#### PersonViewModel.cs
ViewModel для работы со списком сотрудников:
- `ListPerson` - коллекция объектов PersonDPO для отображения
- `SelectedPersonDPO` - выбранный сотрудник в списке
- `_vmPerson` - внутренняя коллекция объектов Person
- `_vmRole` - внутренняя коллекция объектов Role
- `Roles` - свойство для доступа к коллекции должностей
- `AddPerson` - команда добавления нового сотрудника
- `EditPerson` - команда редактирования сотрудника
- `DeletePerson` - команда удаления сотрудника
- `FillPersonDPO` - метод заполнения коллекции ListPerson данными из _vmPerson
- `GetNextPersonId` - метод получения следующего доступного ID

#### RoleViewModel.cs
ViewModel для работы со списком должностей:
- `ListRole` - коллекция должностей
- `SelectedRole` - выбранная должность в списке
- `AddRole` - команда добавления новой должности
- `EditRole` - команда редактирования должности
- `DeleteRole` - команда удаления должности
- `GetNextRoleId` - метод получения следующего доступного ID

### Представления (View)

#### MainWindow.xaml
Главное окно приложения с меню для перехода к управлению сотрудниками и должностями.

#### WindowEmployee.xaml
Окно со списком сотрудников, с возможностью добавления, редактирования и удаления:
- ListView для отображения списка сотрудников
- Кнопки для операций добавления, редактирования и удаления, связанные с командами через привязку данных

#### WindowRole.xaml
Окно со списком должностей, с возможностью добавления, редактирования и удаления:
- ListView для отображения списка должностей
- Кнопки для операций добавления, редактирования и удаления, связанные с командами через привязку данных

#### EditEmployeeWindow.xaml
Диалоговое окно для добавления или редактирования сотрудника:
- Поля для ввода имени, фамилии, выбора должности и даты рождения
- Кнопки сохранения и отмены

#### EditRoleWindow.xaml
Диалоговое окно для добавления или редактирования должности:
- Поле для ввода наименования должности
- Кнопки сохранения и отмены

## Функциональность приложения

### Управление сотрудниками
- Просмотр списка сотрудников с информацией о должности, имени, фамилии и дате рождения
- Добавление нового сотрудника через диалоговое окно
- Редактирование выбранного сотрудника через диалоговое окно
- Удаление выбранного сотрудника с подтверждением

### Управление должностями
- Просмотр списка должностей
- Добавление новой должности через диалоговое окно
- Редактирование выбранной должности через диалоговое окно
- Удаление выбранной должности с подтверждением

## Реализация MVVM паттерна и паттерна Command

В данном приложении паттерн MVVM и паттерн Command реализованы следующим образом:

1. **Модель (Model)** - классы `Person`, `Role`, `PersonDPO` и `FindRole` содержат данные и бизнес-логику. Модели реализуют интерфейс `INotifyPropertyChanged` для уведомления об изменениях свойств.

2. **Представление (View)** - XAML-файлы, которые определяют UI и пользовательские взаимодействия. Взаимодействие с ViewModel осуществляется через привязку данных и команды.

3. **Модель представления (ViewModel)** - классы `PersonViewModel` и `RoleViewModel`, которые инкапсулируют логику представления и состояние, обеспечивают связь между моделью и представлением. ViewModel содержат команды для обработки действий пользователя.

4. **Команды (Commands)** - класс `RelayCommand` реализует интерфейс `ICommand` и используется для связывания действий в пользовательском интерфейсе с методами ViewModel через привязку данных, без использования обработчиков событий в code-behind.

### Связывание данных
Для связывания данных используются:
- `ObservableCollection<T>` для коллекций, которые автоматически уведомляют UI об изменениях
- Интерфейс `INotifyPropertyChanged` для уведомления об изменениях в свойствах
- Привязки данных в XAML через атрибут `Binding`
- Привязки команд в XAML через атрибут `Command`

## Как использовать приложение

1. При запуске открывается главное окно с меню
2. Выберите "Сотрудники" для работы со списком сотрудников или "Должности" для работы со списком должностей
3. Для добавления нажмите кнопку "Добавить"
4. Для редактирования выберите элемент в списке и нажмите "Редактировать"
5. Для удаления выберите элемент в списке и нажмите "Удалить"

## Технические особенности

- Приложение написано на C# с использованием WPF
- Поддерживает .NET 6.0
- Использует стандартные элементы управления WPF (ListView, GridView, DatePicker, ComboBox, etc.)
- Реализует паттерн MVVM для разделения ответственности
- Применяет паттерн Command для обработки пользовательских действий без использования обработчиков событий 